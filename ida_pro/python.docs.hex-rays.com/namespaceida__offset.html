<!-- HTML header for doxygen 1.9.3-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IDAPython: ida_offset Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">
  DoxygenAwesomeDarkModeToggle.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="style.css" rel="stylesheet" type="text/css"/>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y2G1VBHRDB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-Y2G1VBHRDB');
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="idapython.svg"/></td>
  <td id="projectalign">
   <div id="projectname">IDAPython<span id="projectnumber">&#160;9.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('namespaceida__offset.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">ida_offset Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Functions that deal with offsets.

"Being an offset" is a characteristic of an operand. This means that operand or its part represent offset from some address in the program. This linear address is called "offset base". Some operands may have 2 offsets simultaneously. Generally, IDA doesn't handle this except for Motorola outer offsets. Thus there may be two offset values in an operand: simple offset and outer offset.
Outer offsets are handled by specifying special operand number: it should be ORed with OPND_OUTER value.
See bytes.hpp for further explanation of operand numbers. </pre> </div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abee83bff060360788673da1eb0c39cd5" id="r_abee83bff060360788673da1eb0c39cd5"><td class="memItemLeft" align="right" valign="top">'reftype_t'&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abee83bff060360788673da1eb0c39cd5">get_default_reftype</a> (<a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a> ea)</td></tr>
<tr class="separator:abee83bff060360788673da1eb0c39cd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab32b4ab77ccf4177cd3e78a4650454c4" id="r_ab32b4ab77ccf4177cd3e78a4650454c4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab32b4ab77ccf4177cd3e78a4650454c4">op_offset_ex</a> (<a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a> ea, int n, 'refinfo_t' ri)</td></tr>
<tr class="separator:ab32b4ab77ccf4177cd3e78a4650454c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4df996313a25d7050fd6afd592f456c4" id="r_a4df996313a25d7050fd6afd592f456c4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4df996313a25d7050fd6afd592f456c4">op_offset</a> (*args)</td></tr>
<tr class="separator:a4df996313a25d7050fd6afd592f456c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2092a08d722b3bb5a4a445e72fd4c0fe" id="r_a2092a08d722b3bb5a4a445e72fd4c0fe"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2092a08d722b3bb5a4a445e72fd4c0fe">op_plain_offset</a> (<a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a> ea, int n, <a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a> base)</td></tr>
<tr class="separator:a2092a08d722b3bb5a4a445e72fd4c0fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a890c1eb83bdd04e02d03dcc67872fc65" id="r_a890c1eb83bdd04e02d03dcc67872fc65"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a890c1eb83bdd04e02d03dcc67872fc65">get_offbase</a> (<a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a> ea, int n)</td></tr>
<tr class="separator:a890c1eb83bdd04e02d03dcc67872fc65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1730a0cf3eab9c663994cbbc3e7501cc" id="r_a1730a0cf3eab9c663994cbbc3e7501cc"><td class="memItemLeft" align="right" valign="top">str&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1730a0cf3eab9c663994cbbc3e7501cc">get_offset_expression</a> (<a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a> ea, int n, <a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a> _from, 'adiff_t' offset, int getn_flags=0)</td></tr>
<tr class="separator:a1730a0cf3eab9c663994cbbc3e7501cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa72600eadcd82d384e7481235483a1e8" id="r_aa72600eadcd82d384e7481235483a1e8"><td class="memItemLeft" align="right" valign="top">str&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa72600eadcd82d384e7481235483a1e8">get_offset_expr</a> (<a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a> ea, int n, 'refinfo_t' ri, <a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a> _from, 'adiff_t' offset, int getn_flags=0)</td></tr>
<tr class="separator:aa72600eadcd82d384e7481235483a1e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7021446e487ffa78b518264557baadf3" id="r_a7021446e487ffa78b518264557baadf3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7021446e487ffa78b518264557baadf3">can_be_off32</a> (<a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a> ea)</td></tr>
<tr class="separator:a7021446e487ffa78b518264557baadf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e8496c0defc79df7f922394db69e2c5" id="r_a2e8496c0defc79df7f922394db69e2c5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2e8496c0defc79df7f922394db69e2c5">calc_offset_base</a> (<a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a> ea, int n)</td></tr>
<tr class="separator:a2e8496c0defc79df7f922394db69e2c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87fa6a1f4efa7dcb1c485b26c8880aa8" id="r_a87fa6a1f4efa7dcb1c485b26c8880aa8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a87fa6a1f4efa7dcb1c485b26c8880aa8">calc_probable_base_by_value</a> (<a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a> ea, int off)</td></tr>
<tr class="separator:a87fa6a1f4efa7dcb1c485b26c8880aa8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a314618413aa0619f2c3bc3f68601c0d6" id="r_a314618413aa0619f2c3bc3f68601c0d6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a314618413aa0619f2c3bc3f68601c0d6">calc_reference_data</a> ('ea_t *' target, 'ea_t *' base, <a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a> _from, 'refinfo_t' ri, 'adiff_t' opval)</td></tr>
<tr class="separator:a314618413aa0619f2c3bc3f68601c0d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8c84deeffdec885ad29ad1a0e134cc6" id="r_ae8c84deeffdec885ad29ad1a0e134cc6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae8c84deeffdec885ad29ad1a0e134cc6">add_refinfo_dref</a> ('insn_t const &amp;' insn, <a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a> _from, 'refinfo_t' ri, 'adiff_t' opval, 'dref_t' type, int opoff)</td></tr>
<tr class="separator:ae8c84deeffdec885ad29ad1a0e134cc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4082b2b3f0f8c779177845a846c039f6" id="r_a4082b2b3f0f8c779177845a846c039f6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4082b2b3f0f8c779177845a846c039f6">calc_target</a> (*args)</td></tr>
<tr class="separator:a4082b2b3f0f8c779177845a846c039f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae04aeefd89ed4936dab404b7edef4689" id="r_ae04aeefd89ed4936dab404b7edef4689"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae04aeefd89ed4936dab404b7edef4689">calc_basevalue</a> (<a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a> target, <a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a> base)</td></tr>
<tr class="separator:ae04aeefd89ed4936dab404b7edef4689"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ae8c84deeffdec885ad29ad1a0e134cc6" name="ae8c84deeffdec885ad29ad1a0e134cc6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8c84deeffdec885ad29ad1a0e134cc6">&#9670;&#160;</a></span>add_refinfo_dref()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a> add_refinfo_dref </td>
          <td>(</td>
          <td class="paramtype">'insn_t const &amp;'</td>          <td class="paramname"><span class="paramname"><em>insn</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a></td>          <td class="paramname"><span class="paramname"><em>_from</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">
    'refinfo_t'</td>          <td class="paramname"><span class="paramname"><em>ri</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">'adiff_t'</td>          <td class="paramname"><span class="paramname"><em>opval</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">'dref_t'</td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int
    </td>          <td class="paramname"><span class="paramname"><em>opoff</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Add xrefs for a reference from the given instruction ( insn_t::ea). This function creates a cross references to the target and the base. insn_t::add_off_drefs() calls this function to create xrefs for 'offset' operand. 
    
@param insn: the referencing instruction
@param ri: reference info block from the database
@param opval: operand value (usually op_t::value or op_t::addr)
@param type: type of xref
@param opoff: offset of the operand from the start of instruction
@returns the target address of the reference</pre> 
</div>
</div>
<a id="ae04aeefd89ed4936dab404b7edef4689" name="ae04aeefd89ed4936dab404b7edef4689"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae04aeefd89ed4936dab404b7edef4689">&#9670;&#160;</a></span>calc_basevalue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a> calc_basevalue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a></td>          <td class="paramname"><span class="paramname"><em>target</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a>
    </td>          <td class="paramname"><span class="paramname"><em>base</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Calculate the value of the reference base.
</pre> 
</div>
</div>
<a id="a2e8496c0defc79df7f922394db69e2c5" name="a2e8496c0defc79df7f922394db69e2c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e8496c0defc79df7f922394db69e2c5">&#9670;&#160;</a></span>calc_offset_base()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a> calc_offset_base </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a></td>          <td class="paramname"><span class="paramname"><em>ea</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Try to calculate the offset base This function takes into account the fixup information, current ds and cs values. 
    
@param ea: the referencing instruction/data address
@param n: operand number
* 0: first operand
* 1: second operand
* ...
* 7: eighth operand
@returns output base address or BADADDR</pre> 
</div>
</div>
<a id="a87fa6a1f4efa7dcb1c485b26c8880aa8" name="a87fa6a1f4efa7dcb1c485b26c8880aa8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87fa6a1f4efa7dcb1c485b26c8880aa8">&#9670;&#160;</a></span>calc_probable_base_by_value()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a> calc_probable_base_by_value </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a></td>          <td class="paramname"><span class="paramname"><em>ea</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int
    </td>          <td class="paramname"><span class="paramname"><em>off</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Try to calculate the offset base. 2 bases are checked: current ds and cs. If fails, return BADADDR </pre> 
</div>
</div>
<a id="a314618413aa0619f2c3bc3f68601c0d6" name="a314618413aa0619f2c3bc3f68601c0d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a314618413aa0619f2c3bc3f68601c0d6">&#9670;&#160;</a></span>calc_reference_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool calc_reference_data </td>
          <td>(</td>
          <td class="paramtype">'ea_t *'</td>          <td class="paramname"><span class="paramname"><em>target</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">'ea_t *'</td>          <td class="paramname"><span class="paramname"><em>base</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">
    <a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a></td>          <td class="paramname"><span class="paramname"><em>_from</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">'refinfo_t'</td>          <td class="paramname"><span class="paramname"><em>ri</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">'adiff_t'</td>          <td class="paramname"><span class="paramname"><em>opval</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Calculate the target and base addresses of an offset expression. The calculated target and base addresses are returned in the locations pointed by 'base' and 'target'. In case 'ri.base' is BADADDR, the function calculates the offset base address from the referencing instruction/data address. The target address is copied from ri.target. If ri.target is BADADDR then the target is calculated using the base address and 'opval'. This function also checks if 'opval' matches the full value of the reference and takes in account the memory-mapping. 
    
@param target: output target address
@param base: output base address
@param ri: reference info block from the database
@param opval: operand value (usually op_t::value or op_t::addr)
@returns success</pre> 
</div>
</div>
<a id="a4082b2b3f0f8c779177845a846c039f6" name="a4082b2b3f0f8c779177845a846c039f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4082b2b3f0f8c779177845a846c039f6">&#9670;&#160;</a></span>calc_target()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a> calc_target </td>
          <td>(</td>
          <td class="paramtype">*</td>          <td class="paramname"><span class="paramname"><em>args</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This function has the following signatures:

0. calc_target(from: ida_idaapi.ea_t, opval: adiff_t, ri: const refinfo_t &amp;) -&gt; ida_idaapi.ea_t
1. calc_target(from: ida_idaapi.ea_t, ea: ida_idaapi.ea_t, n: int, opval: adiff_t) -&gt; ida_idaapi.ea_t

# 0: calc_target(from: ida_idaapi.ea_t, opval: adiff_t, ri: const refinfo_t &amp;) -&gt; ida_idaapi.ea_t

Calculate the target using the provided refinfo_t.


# 1: calc_target(from: ida_idaapi.ea_t, ea: ida_idaapi.ea_t, n: int, opval: adiff_t) -&gt; ida_idaapi.ea_t

Retrieve refinfo_t structure and calculate the target.</pre> 
</div>
</div>
<a id="a7021446e487ffa78b518264557baadf3" name="a7021446e487ffa78b518264557baadf3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7021446e487ffa78b518264557baadf3">&#9670;&#160;</a></span>can_be_off32()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a> can_be_off32 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a></td>          <td class="paramname"><span class="paramname"><em>ea</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Does the specified address contain a valid OFF32 value?. For symbols in special segments the displacement is not taken into account. If yes, then the target address of OFF32 will be returned. If not, then BADADDR is returned. </pre> 
</div>
</div>
<a id="abee83bff060360788673da1eb0c39cd5" name="abee83bff060360788673da1eb0c39cd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abee83bff060360788673da1eb0c39cd5">&#9670;&#160;</a></span>get_default_reftype()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">'reftype_t' get_default_reftype </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a></td>          <td class="paramname"><span class="paramname"><em>ea</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Get default reference type depending on the segment. 
    
@returns one of REF_OFF8, REF_OFF16, REF_OFF32, REF_OFF64</pre> 
</div>
</div>
<a id="a890c1eb83bdd04e02d03dcc67872fc65" name="a890c1eb83bdd04e02d03dcc67872fc65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a890c1eb83bdd04e02d03dcc67872fc65">&#9670;&#160;</a></span>get_offbase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a> get_offbase </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a></td>          <td class="paramname"><span class="paramname"><em>ea</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Get offset base value 
    
@param ea: linear address
@param n: 0..UA_MAXOP-1 operand number
@returns offset base or BADADDR</pre> 
</div>
</div>
<a id="aa72600eadcd82d384e7481235483a1e8" name="aa72600eadcd82d384e7481235483a1e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa72600eadcd82d384e7481235483a1e8">&#9670;&#160;</a></span>get_offset_expr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">str get_offset_expr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a></td>          <td class="paramname"><span class="paramname"><em>ea</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">'refinfo_t'</td>          <td class="paramname"><span class="paramname"><em>ri</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">
    <a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a></td>          <td class="paramname"><span class="paramname"><em>_from</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">'adiff_t'</td>          <td class="paramname"><span class="paramname"><em>offset</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>getn_flags</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">See get_offset_expression()
</pre> 
</div>
</div>
<a id="a1730a0cf3eab9c663994cbbc3e7501cc" name="a1730a0cf3eab9c663994cbbc3e7501cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1730a0cf3eab9c663994cbbc3e7501cc">&#9670;&#160;</a></span>get_offset_expression()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">str get_offset_expression </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a></td>          <td class="paramname"><span class="paramname"><em>ea</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">
    <a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a></td>          <td class="paramname"><span class="paramname"><em>_from</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">'adiff_t'</td>          <td class="paramname"><span class="paramname"><em>offset</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>getn_flags</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Get offset expression (in the form "offset name+displ"). This function uses offset translation function ( processor_t::translate) if your IDP module has such a function. Translation function is used to map linear addresses in the program (only for offsets).
Example: suppose we have instruction at linear address 0x00011000: `mov     ax, [bx+7422h] ` and at ds:7422h: `array   dw      ... ` We want to represent the second operand with an offset expression, so then we call: `get_offset_expresion(0x001100, 1, 0x001102, 0x7422, buf);
                 |         |  |         |       |
                 |         |  |         |       +output buffer
                 |         |  |         +value of offset expression
                 |         |  +address offset value in the instruction
                 |         +the second operand
                 +address of instruction` and the function will return a colored string: `offset array ` 
    
@param ea: start of instruction or data with the offset expression
@param n: operand number (may be ORed with OPND_OUTER)
* 0: first operand
* 1: second operand
* ...
* 7: eighth operand
@param offset: value of operand or its part. The function will return text representation of this value as offset expression.
@param getn_flags: combination of:
* GETN_APPZERO: meaningful only if the name refers to a structure. appends the struct field name if the field offset is zero
* GETN_NODUMMY: do not generate dummy names for the expression but pretend they already exist (useful to verify that the offset expression can be represented)
@retval 0: can't convert to offset expression
@retval 1: ok, a simple offset expression
@retval 2: ok, a complex offset expression</pre> 
</div>
</div>
<a id="a4df996313a25d7050fd6afd592f456c4" name="a4df996313a25d7050fd6afd592f456c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4df996313a25d7050fd6afd592f456c4">&#9670;&#160;</a></span>op_offset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool op_offset </td>
          <td>(</td>
          <td class="paramtype">*</td>          <td class="paramname"><span class="paramname"><em>args</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">See op_offset_ex()
</pre> 
</div>
</div>
<a id="ab32b4ab77ccf4177cd3e78a4650454c4" name="ab32b4ab77ccf4177cd3e78a4650454c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab32b4ab77ccf4177cd3e78a4650454c4">&#9670;&#160;</a></span>op_offset_ex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool op_offset_ex </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a></td>          <td class="paramname"><span class="paramname"><em>ea</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">'refinfo_t'</td>          <td class="paramname"><span class="paramname"><em>ri</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Convert operand to a reference. To delete an offset, use clr_op_type() function. 
    
@param ea: linear address. if 'ea' has unexplored bytes, try to convert them to
* no segment: fail
* 16bit segment: to 16bit word data
* 32bit segment: to dword
@param n: operand number (may be ORed with OPND_OUTER)
* 0: first
* 1: second
* ...
* 7: eighth operand


* OPND_MASK: all operands
@param ri: reference information
@returns success</pre> 
</div>
</div>
<a id="a2092a08d722b3bb5a4a445e72fd4c0fe" name="a2092a08d722b3bb5a4a445e72fd4c0fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2092a08d722b3bb5a4a445e72fd4c0fe">&#9670;&#160;</a></span>op_plain_offset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool op_plain_offset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a></td>          <td class="paramname"><span class="paramname"><em>ea</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceida__idaapi.html#a7b0aeaed04e477c02cf8ea3452002d1a">ida_idaapi.ea_t</a></td>          <td class="paramname"><span class="paramname"><em>base</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Convert operand to a reference with the default reference type.
</pre> 
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceida__offset.html">ida_offset</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
